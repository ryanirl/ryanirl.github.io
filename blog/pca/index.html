<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet"><meta name="generator" content="Astro v4.12.2"><title>Principle Component Analysis</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"><script type="text/partytown" defer data-domain="ryanirl.github.io" src="https://plausible.io/js/script.js"></script><link rel="stylesheet" href="/_astro/about.C6sz8r5x.css">
<style>.citation-tooltip[data-astro-cid-eqo3tkq5]{display:none;position:absolute;background-color:var(--tooltip-bg);color:var(--tooltip-text);border:1px solid var(--tooltip-border);padding:10px;border-radius:4px;font-size:.9em;max-width:500px;z-index:1000;box-shadow:0 2px 5px #0003}.citation-tooltip[data-astro-cid-eqo3tkq5] a[data-astro-cid-eqo3tkq5]{color:var(--tooltip-link);text-decoration:underline}.references-list[data-astro-cid-eqo3tkq5]{padding-left:20px}:root{--tooltip-bg: #f9f9f9;--tooltip-text: #333;--tooltip-border: #ccc;--tooltip-link: #0000EE}:root.dark{--tooltip-bg: #2a2a2a;--tooltip-text: #e0e0e0;--tooltip-border: #555;--tooltip-link: #879eff}.citation-ref[data-astro-cid-tbsazfha]{cursor:pointer;color:var(--citation-color)}:root{--citation-color: #6d6dbf}:root.dark{--citation-color: #8089b4}.break-words[data-astro-cid-xj2uyz6m]{word-wrap:break-word;overflow-wrap:break-word;-webkit-hyphens:auto;hyphens:auto}.break-all[data-astro-cid-xj2uyz6m]{word-break:break-all}.grid-0[data-astro-cid-whmuftws]{flex:none}@media (min-width: 768px){.grid-0[data-astro-cid-whmuftws]{width:12rem}}.grid-1[data-astro-cid-whmuftws]{flex:0 1 auto}@media (min-width: 768px){.grid-1[data-astro-cid-whmuftws]{width:73rem}}.grid-2[data-astro-cid-whmuftws]{flex:0 1 auto}@media (min-width: 768px){.grid-2[data-astro-cid-whmuftws]{width:0rem}}
</style>
<link rel="stylesheet" href="/_astro/gamblers_ruin.DtVBE6KU.css">
<style>.light-text[data-astro-cid-oemx5le4]{display:none}.dark-text[data-astro-cid-oemx5le4],.dark .light-text[data-astro-cid-oemx5le4]{display:inline}.dark .dark-text[data-astro-cid-oemx5le4]{display:none}
</style><script type="module">const l=JSON.parse(document.getElementById("citations-data").textContent),o=document.getElementById("citationTooltip");let a;function u(t,e){clearTimeout(a),o.innerHTML=`
      <strong>${e.title}</strong><br>
      ${e.authors.join(", ")} (${e.year})
      ${e.url?`<br><a href="${e.url}" target="_blank" rel="noopener noreferrer">View source</a>`:""}
    `,o.style.display="block";const i=o.getBoundingClientRect(),s=window.innerWidth,r=window.innerHeight;let n=t.pageX+10;n+i.width>s&&(n=Math.max(0,s-i.width));let d=t.pageY+10;d+i.height>r&&(d=Math.max(0,t.pageY-i.height-10)),o.style.left=`${n}px`,o.style.top=`${d}px`}function c(){a=setTimeout(()=>{o.style.display="none"},300)}document.body.addEventListener("mouseover",t=>{const e=t.target;if(e.closest(".citation-ref")){const i=e.closest(".citation-ref"),s=parseInt(i.dataset.citationId),r=l.find(n=>n.id===s);r&&u(t,r)}});document.body.addEventListener("mouseout",t=>{t.target.closest(".citation-ref")&&c()});o.addEventListener("mouseover",()=>{clearTimeout(a)});o.addEventListener("mouseout",c);
</script>
<script>!(function(w,p,f,c){if(!window.crossOriginIsolated && !navigator.serviceWorker) return;c=w[p]=Object.assign(w[p]||{},{"lib":"/~partytown/","debug":false});c[f]=(c[f]||[]).concat(["dataLayer.push"])})(window,'partytown','forward');/* Partytown 0.10.2 - MIT builder.io */
const t={preserveBehavior:!1},e=e=>{if("string"==typeof e)return[e,t];const[n,r=t]=e;return[n,{...t,...r}]},n=Object.freeze((t=>{const e=new Set;let n=[];do{Object.getOwnPropertyNames(n).forEach((t=>{"function"==typeof n[t]&&e.add(t)}))}while((n=Object.getPrototypeOf(n))!==Object.prototype);return Array.from(e)})());!function(t,r,o,i,a,s,c,d,l,p,u=t,f){function h(){f||(f=1,"/"==(c=(s.lib||"/~partytown/")+(s.debug?"debug/":""))[0]&&(l=r.querySelectorAll('script[type="text/partytown"]'),i!=t?i.dispatchEvent(new CustomEvent("pt1",{detail:t})):(d=setTimeout(v,1e4),r.addEventListener("pt0",w),a?y(1):o.serviceWorker?o.serviceWorker.register(c+(s.swPath||"partytown-sw.js"),{scope:c}).then((function(t){t.active?y():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&y()}))}),console.error):v())))}function y(e){p=r.createElement(e?"script":"iframe"),t._pttab=Date.now(),e||(p.style.display="block",p.style.width="0",p.style.height="0",p.style.border="0",p.style.visibility="hidden",p.setAttribute("aria-hidden",!0)),p.src=c+"partytown-"+(e?"atomics.js?v=0.10.2":"sandbox-sw.html?"+t._pttab),r.querySelector(s.sandboxParent||"body").appendChild(p)}function v(n,o){for(w(),i==t&&(s.forward||[]).map((function(n){const[r]=e(n);delete t[r.split(".")[0]]})),n=0;n<l.length;n++)(o=r.createElement("script")).innerHTML=l[n].innerHTML,o.nonce=s.nonce,r.head.appendChild(o);p&&p.parentNode.removeChild(p)}function w(){clearTimeout(d)}s=t.partytown||{},i==t&&(s.forward||[]).map((function(r){const[o,{preserveBehavior:i}]=e(r);u=t,o.split(".").map((function(e,r,o){var a;u=u[o[r]]=r+1<o.length?u[o[r]]||(a=o[r+1],n.includes(a)?[]:{}):(()=>{let e=null;if(i){const{methodOrProperty:n,thisObject:r}=((t,e)=>{let n=t;for(let t=0;t<e.length-1;t+=1)n=n[e[t]];return{thisObject:n,methodOrProperty:e.length>0?n[e[e.length-1]]:void 0}})(t,o);"function"==typeof n&&(e=(...t)=>n.apply(r,...t))}return function(){let n;return e&&(n=e(arguments)),(t._ptf=t._ptf||[]).push(o,arguments),n}})()}))})),"complete"==r.readyState?h():(t.addEventListener("DOMContentLoaded",h),t.addEventListener("load",h))}(window,document,navigator,top,window.crossOriginIsolated);;(e=>{e.addEventListener("astro:before-swap",e=>{let r=document.body.querySelector("iframe[src*='/~partytown/']");e.newDocument.body.append(r)})})(document);</script></head> <body class="bg-[#fafbfd] dark:bg-[#1d1e20] flex flex-col min-h-screen  tracking-[-0.01rem]"> <nav class="sticky bg-[#fafbfd] dark:bg-[#1d1e20] top-0 z-50" data-astro-cid-whmuftws> <div class="max-w-[85rem] mx-auto w-full pt-4 pb-0 mb-1" data-astro-cid-whmuftws> <div class="md:px-6 px-4 flex items-center" data-astro-cid-whmuftws> <div class="grid-0" data-astro-cid-whmuftws> <a href="/" class="md:inline hidden text-nowrap text-black font-medium text-[1.34rem] dark:text-gray-200 tracking-[-0.02rem]" data-astro-cid-whmuftws>
Ryan Peters
</a> </div> <div class="grid-1 flex justify-start w-[75rem]" data-astro-cid-whmuftws> <a href="/" class="md:ml-0 decoration-2 underline-offset-4 flex items-center dark:hover:text-gray-400 hover:text-gray-500 transition-colors duration-200 text-lg font-base text-gray-900 dark:text-gray-300" data-astro-cid-whmuftws>
Blog
</a> <a href="/news" class="ml-6 decoration-2 underline-offset-4 flex items-center dark:hover:text-gray-400 hover:text-gray-500 transition-colors duration-200 text-lg font-base text-gray-900 dark:text-gray-300" data-astro-cid-whmuftws>
News
</a> <a href="/about" class="ml-6 decoration-2 underline-offset-4 flex items-center dark:hover:text-gray-400 hover:text-gray-500 transition-colors duration-200 text-lg font-base text-gray-900 dark:text-gray-300" data-astro-cid-whmuftws>
About
</a> </div> <div class="grid-2 flex justify-end w-[15rem]" data-astro-cid-whmuftws> <button id="themeToggle" class="theme-toggle" data-astro-cid-oemx5le4> <span class="light-text text-gray-300 text-lg hover:text-gray-400 transition-colors duration-200 " data-astro-cid-oemx5le4>Light</span> <span class="dark-text text-lg hover:text-gray-500 transition-colors duration-200" data-astro-cid-oemx5le4>Dark</span> </button>  <script>
  const theme = (() => {
    if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
      return localStorage.getItem('theme');
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark';
    }
    return 'light';
  })();

  if (theme === 'light') {
    document.documentElement.setAttribute("data-mode", 'light');
    document.documentElement.classList.remove('dark');
  } else {
    document.documentElement.setAttribute("data-mode", 'dark');
    document.documentElement.classList.add('dark');
  }

  window.localStorage.setItem('theme', theme);

  const handleToggleClick = () => {
    const element = document.documentElement;
    element.classList.toggle("dark");
    const isDark = element.classList.contains("dark");
    localStorage.setItem("theme", isDark ? "dark" : "light");
    element.setAttribute("data-mode", isDark ? "dark" : "light");
  }

  document.getElementById("themeToggle").addEventListener("click", handleToggleClick);
</script> </div> </div> </div> </nav>  <div class="max-w-3xl mx-auto w-full px-4"> <div class="text-gray-500 dark:text-gray-400 font-base pt-16 pb-2"> April 26, 2023 </div> <h1 class="text-gray-900 dark:text-gray-100 pr-5 text-3xl font-semibold mb-2">Principle Component Analysis</h1> <div> <span class="author text-gray-800 dark:text-gray-300"> <b>Authors:</b> </span>
          <span class="author text-gray-500 dark:text-gray-400 font-base"> Ryan Peters<sup>*</sup>  </span> </div> <div class="text-gray-500 dark:text-gray-400 font-base text-sm pt-4"> <span>* Core Contributor;</span> <span class="pl-4">Correspondence to ryanirl@icloud.com;</span> </div> <div data-astro-cid-xj2uyz6m> <div class="text-base max-w-3xl prose dark:prose-invert text-gray-900 dark:text-gray-200 my-8 break-words" data-astro-cid-xj2uyz6m>  <p>This post is a derivative of a talk that I gave at the ML@UMN club on April
25th, 2023. The original Kaggle notebook, and all of the associated code, for
this talk can be found
<a href="https://www.kaggle.com/code/ryanirl/ml-umn-pca-clustering-on-genomic-data" target="_blank">here</a>.
The goal of this talk (and this post) was to give a quick overview of vector
projections, formally derive principle component analysis (PCA), and then go
through a from-scratch implementation of PCA (in Python) within the context of
performing dimensionality reduction of genotype data in hopes of being able to
visualize some underlying latent structure of the high dimensional dataset.</p>
<p>Principle component analysis (PCA) is an unsupervised method for dimensionality
reduction. At a high level, this is done by finding vectors that point in the
direction of <em>maximum variance</em> within our dataset, and then projecting our
dataset onto these vectors. While PCA has many application, it’s commonly used
to visualize high dimensional datasets in 2/3 dimensions, reduce noise
(whitening), or as a preprocessing step for downstream applications.</p>
<h2 id="projections">Projections</h2>
<p>As previously mentioned, PCA is performed by projecting our original dataset
into a lower-dimensional subspace that preserves as much variance as possible.
To do this, we must first talk about what is meant by a <em>projection</em>.</p>
<p>Assume that we have some dataset <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">X</mtext><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>d</mi><mi>x</mi><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\textbf{X} \in \mathbb{R}^{dxn}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7252em;vertical-align:-0.0391em"></span><span class="mord text"><span class="mord textbf">X</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> with
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span> samples and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span> dimensions, that we want to project into a lower dimension.
Also, let’s assume <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span> is mean centered (this doesn’t matter now, but will be
important later on).</p>
<p>Now, let’s consider the case of projecting an arbitrary point in this dataset
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>d</mi><mi>x</mi><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">x \in \mathbb{R}^{dx1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> onto an arbitrary vector <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">v</mtext><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>d</mi><mi>x</mi><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\textbf{v} \in \mathbb{R}^{dx1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em"></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>.
Here the notation we will use will be <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mn>1</mn><mi>x</mi><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">X_i \in \mathbb{R}^{1xn}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> to index the feature
space, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>d</mi><mi>x</mi><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">X^{(i)} \in \mathbb{R}^{dx1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9271em;vertical-align:-0.0391em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> to index the sample space.</p>
<center><figure><img src="/img/pca/scaler_v_vector.png" width="95%"/><figcaption><b>Figure 1:</b> Scalar and vector projections.</figcaption></figure></center>
<p>Notice that we could do two kinds of projections. First, we could just get
the scalar projection to find the distance along <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">v</mtext></mrow><annotation encoding="application/x-tex">\textbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span> the projected
point is (<strong>Figure 1</strong> left), or we could find the vector in the direction of
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">v</mtext></mrow><annotation encoding="application/x-tex">\textbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span> with magnitude equal to the scalar projection (<strong>Figure 1</strong> right).
Just by looking at the graph above, you should be able to convince yourself of the
following equations:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>scalar projection</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">∥</mo><mi>x</mi><mo stretchy="false">∥</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">∥</mo><mi>x</mi><mo stretchy="false">∥</mo><mfrac><mrow><msup><mi>x</mi><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext></mrow><mrow><mo stretchy="false">∥</mo><mi>x</mi><mo stretchy="false">∥</mo><mo stretchy="false">∥</mo><mtext mathvariant="bold">v</mtext><mo stretchy="false">∥</mo></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><msup><mi>x</mi><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext></mrow><mrow><mo stretchy="false">∥</mo><mtext mathvariant="bold">v</mtext><mo stretchy="false">∥</mo></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{scalar projection} &amp;= \lVert x \rVert cos(\theta) \\
                         &amp;= \lVert x \rVert \frac{x^\top \textbf{v}}{\lVert x \rVert \lVert \textbf{v} \rVert} \\
                         &amp;= \frac{x^\top \textbf{v}}{\lVert \textbf{v} \rVert} \\
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.0242em;vertical-align:-3.2621em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.7621em"><span style="top:-6.4482em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"><span class="mord text"><span class="mord">scalar projection</span></span></span></span><span style="top:-4.2621em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"></span></span><span style="top:-1.5em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.2621em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.7621em"><span style="top:-6.4482em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mopen">∥</span><span class="mord mathnormal">x</span><span class="mclose">∥</span><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span><span style="top:-4.2621em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mopen">∥</span><span class="mord mathnormal">x</span><span class="mclose">∥</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">∥</span><span class="mord mathnormal">x</span><span class="mclose">∥</span><span class="mopen">∥</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose">∥</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.5em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">∥</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose">∥</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.2621em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Interpreting the above, given that the dot product of two vectors represent the
amount of one vector in the direction of the other vector, this result
intuitively makes sense. That is, the scaler projection is just the dot product
of the vector given by the point <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span> and the unit vector
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mtext mathvariant="bold">v</mtext><mrow><mo stretchy="false">∥</mo><mtext mathvariant="bold">v</mtext><mo stretchy="false">∥</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\textbf{v}}{\lVert \textbf{v} \rVert}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7051em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">∥</span><span class="mord text mtight"><span class="mord textbf mtight">v</span></span><span class="mclose mtight">∥</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>.</p>
<p>The vector projection (inverse reconstruction of our data given projected data
and vectors) is then:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>vector projection</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><msup><mi>x</mi><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext></mrow><mrow><mo stretchy="false">∥</mo><mtext mathvariant="bold">v</mtext><mo stretchy="false">∥</mo></mrow></mfrac><mtext mathvariant="bold">v</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{vector projection} &amp;= \frac{x^\top \textbf{v}}{\lVert \textbf{v} \rVert} \textbf{v} \\
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.7621em;vertical-align:-1.1311em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6311em"><span style="top:-3.6311em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"><span class="mord text"><span class="mord">vector projection</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1311em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6311em"><span style="top:-3.6311em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">∥</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose">∥</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1311em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Throughout the rest of this notebook we will make the
assumption that the vector we are projecting our data onto is of unit length.
This will be because we don’t care about the magnitude of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">v</mtext></mrow><annotation encoding="application/x-tex">\textbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span>, but
only the direction, and making this assumption is important for later on. That
is, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo>=</mo><mo stretchy="false">∥</mo><mtext mathvariant="bold">v</mtext><mo stretchy="false">∥</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\textbf{v}^\top \textbf{v} = \lVert \textbf{v} \rVert = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">∥</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span>. Under this
assumption notice that the scaler projection just becomes the dot product, and
the vector projection simplifies to (where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>X</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x = X^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.888em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> for some <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span>):</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>scalar projection</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi>x</mi><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>vector projection</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo stretchy="false">)</mo><mtext mathvariant="bold">v</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>subject to:</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{scalar projection} &amp;= x^\top \textbf{v}\\
\text{vector projection} &amp;= (x^\top \textbf{v}) \textbf{v} \\
\text{subject to:} &amp; \; \textbf{v}^\top \textbf{v} = 1
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.6773em;vertical-align:-2.0887em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5887em"><span style="top:-4.6896em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">scalar projection</span></span></span></span><span style="top:-3.1304em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">vector projection</span></span></span></span><span style="top:-1.5713em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">subject to:</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0887em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5887em"><span style="top:-4.6896em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span></span></span><span style="top:-3.1304em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose">)</span><span class="mord text"><span class="mord textbf">v</span></span></span></span><span style="top:-1.5713em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0887em"><span></span></span></span></span></span></span></span></span></span></span></span>
<h2 id="minimization-of-reconstruction-error">Minimization of Reconstruction Error</h2>
<p>Now we are going to make the claim that minimizing the reconstruction error of our
original data (where the reconstructed data is just the vector projection of our
data onto some subset of vectors) is the same as maximizing the variance of the
projected data.</p>
<center><figure><img src="/img/pca/variance.png" width="100%"/><figcaption><b>Figure 2</b></figcaption></figure></center>
<p>To prove the statement above, notice that the reconstruction error is just the
mean squared error (MSE) of the original dataset with our reconstructed dataset.</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>reconstruction error</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">∥</mo><msup><mi>X</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mo stretchy="false">(</mo><msup><mi>X</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mi mathvariant="normal">⊤</mi></mrow></msup><mtext mathvariant="bold">v</mtext><mo stretchy="false">)</mo><mtext mathvariant="bold">v</mtext><msub><mo stretchy="false">∥</mo><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{reconstruction error} &amp;= \frac{1}{n} \sum_{i = 1}^{n} \lVert X^{(i)} - (X^{(i) \top} \textbf{v}) \textbf{v} \rVert_2 \\
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.2291em;vertical-align:-1.3645em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8645em"><span style="top:-3.8645em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"><span class="mord text"><span class="mord">reconstruction error</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3645em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8645em"><span style="top:-3.8645em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mopen">∥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose">)</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3645em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Which we want to minimize, thus:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mtext mathvariant="bold">v</mtext><mtext>  </mtext><mtext>s.t.</mtext><mtext>  </mtext><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo>=</mo><mn>1</mn></mrow></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">∥</mo><msup><mi>X</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mo stretchy="false">(</mo><msup><mi>X</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mi mathvariant="normal">⊤</mi></mrow></msup><mtext mathvariant="bold">v</mtext><mo stretchy="false">)</mo><mtext mathvariant="bold">v</mtext><msub><mo stretchy="false">∥</mo><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mtext mathvariant="bold">v</mtext><mtext>  </mtext><mtext>s.t.</mtext><mtext>  </mtext><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo>=</mo><mn>1</mn></mrow></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">∥</mo><msup><mi>X</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><msub><mo stretchy="false">∥</mo><mn>2</mn></msub><mo>−</mo><mo stretchy="false">(</mo><msup><mi>X</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mi mathvariant="normal">⊤</mi></mrow></msup><mtext mathvariant="bold">v</mtext><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mtext mathvariant="bold">v</mtext><mtext>  </mtext><mtext>s.t.</mtext><mtext>  </mtext><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo>=</mo><mn>1</mn></mrow></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msup><mi>X</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mi mathvariant="normal">⊤</mi></mrow></msup><mtext mathvariant="bold">v</mtext><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\min_{\textbf{v} \; \text{s.t.} \; \textbf{v}^\top \textbf{v} = 1} &amp; \frac{1}{n} \sum_{i = 1}^{n} \lVert X^{(i)} - (X^{(i) \top} \textbf{v}) \textbf{v} \rVert_2 \\
\min_{\textbf{v} \; \text{s.t.} \; \textbf{v}^\top \textbf{v} = 1} &amp; \frac{1}{n} \sum_{i = 1}^{n} \lVert X^{(i)} \rVert_2 - (X^{(i) \top} \textbf{v})^2 \\
\max_{\textbf{v} \; \text{s.t.} \; \textbf{v}^\top \textbf{v} = 1} &amp; \frac{1}{n} \sum_{i = 1}^{n} (X^{(i) \top} \textbf{v})^2 \\
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.6872em;vertical-align:-4.5936em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.0936em"><span style="top:-7.0936em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em"><span style="top:-2.2866em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span><span class="mspace mtight" style="margin-right:0.3253em"></span><span class="mord text mtight"><span class="mord mtight">s.t.</span></span><span class="mspace mtight" style="margin-right:0.3253em"></span><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text mtight"><span class="mord textbf mtight">v</span></span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8134em"><span></span></span></span></span></span></span></span><span style="top:-3.8645em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em"><span style="top:-2.2866em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span><span class="mspace mtight" style="margin-right:0.3253em"></span><span class="mord text mtight"><span class="mord mtight">s.t.</span></span><span class="mspace mtight" style="margin-right:0.3253em"></span><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text mtight"><span class="mord textbf mtight">v</span></span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8134em"><span></span></span></span></span></span></span></span><span style="top:-0.6355em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.2866em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span><span class="mspace mtight" style="margin-right:0.3253em"></span><span class="mord text mtight"><span class="mord mtight">s.t.</span></span><span class="mspace mtight" style="margin-right:0.3253em"></span><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text mtight"><span class="mord textbf mtight">v</span></span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8134em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.5936em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.0936em"><span style="top:-7.0936em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mopen">∥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose">)</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.8645em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mopen">∥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-0.6355em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.5936em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Thus we have shown that minimizing the reconstruction loss is the same as
maximizing the projection variance.</p>
<h2 id="principle-component-analysis-pca">Principle Component Analysis (PCA)</h2>
<p>So far we have defined what a projection is and shown that minimizing the
reconstruction error of projected data is the same as maximizing the variance
of the projected data. Intuitively, this is what PCA tries to capture. That is,
we want to find the <em>best</em> vectors <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">v</mtext></mrow><annotation encoding="application/x-tex">\textbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span> to project our data down onto,
and have shown that these <em>best</em> vectors are the ones that maximize the variance
of the projected data. Let’s try and solve for this formally:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mtext mathvariant="bold">v</mtext></munder><mtext>  </mtext><mtext>Var</mtext><mtext> </mtext><mo stretchy="false">(</mo><msup><mi>X</mi><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo lspace="0em" rspace="0em">=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mtext mathvariant="bold">v</mtext></munder><mtext>  </mtext><mfrac><mn>1</mn><mi>n</mi></mfrac><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mi>X</mi><msup><mi>X</mi><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
&amp; \max_{\textbf{v}} \; \text{Var} \: (X^\top \textbf{v}) \\[7pt]
=&amp; \max_{\textbf{v}} \; \frac{1}{n} \textbf{v}^\top X X^\top \textbf{v}
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5805em;vertical-align:-2.0403em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5403em"><span style="top:-4.9626em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"></span></span><span style="top:-2.2812em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0403em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5403em"><span style="top:-4.9626em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.4em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord text"><span class="mord">Var</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mclose">)</span></span></span><span style="top:-2.2812em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.4em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0403em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>But notice that to maximize this we could just make the vector we want to
project onto <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">v</mtext></mrow><annotation encoding="application/x-tex">\textbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span> arbitrary large, so we turn this into a constrained
optimization problem. Another interpretation of this would be that we don’t care
about the magnitude of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">v</mtext></mrow><annotation encoding="application/x-tex">\textbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span>, but only the direction, thus we constrain
it’s magnitude to some fixed value (1 for simplicity).</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mtext mathvariant="bold">v</mtext></munder><mtext>  </mtext><mfrac><mn>1</mn><mi>n</mi></mfrac><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mi>X</mi><msup><mi>X</mi><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>subject to:</mtext><mtext>  </mtext><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
&amp; \max_{\textbf{v}} \; \frac{1}{n} \textbf{v}^\top X X^\top \textbf{v} \\[7pt]
&amp; \text{subject to:} \; \textbf{v}^\top \textbf{v} = 1 \\[5pt]
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.7405em;vertical-align:-2.1203em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6203em"><span style="top:-4.6203em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"></span></span><span style="top:-2.3612em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1203em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6203em"><span style="top:-4.6203em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.4em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span></span></span><span style="top:-2.3612em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">subject to:</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1203em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Also notice that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><mi>X</mi><msup><mi>X</mi><mi mathvariant="normal">⊤</mi></msup></mrow><annotation encoding="application/x-tex">\frac{1}{n} X X^\top</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1941em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span></span></span> is just the covariance matrix assuming
our data is mean centered (which was assumed when defining <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span>). So we
can make the substitution <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mi>X</mi><msup><mi>X</mi><mi mathvariant="normal">⊤</mi></msup></mrow><annotation encoding="application/x-tex">\Sigma = \frac{1}{n} X X^\top</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">Σ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1941em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span></span></span>, then the problem
becomes:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mtext mathvariant="bold">v</mtext></munder><mtext>  </mtext><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mi mathvariant="normal">Σ</mi><mtext mathvariant="bold">v</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>subject to:</mtext><mtext>  </mtext><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
&amp; \max_{\textbf{v}} \; \textbf{v}^\top \Sigma \textbf{v} \\[7pt]
&amp; \text{subject to:} \; \textbf{v}^\top \textbf{v} = 1 \\[5pt]
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.3182em;vertical-align:-1.9091em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.4091em"><span style="top:-4.4091em"><span class="pstrut" style="height:2.8991em"></span><span class="mord"></span></span><span style="top:-2.15em"><span class="pstrut" style="height:2.8991em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9091em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.4091em"><span style="top:-4.51em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.4em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord">Σ</span><span class="mord text"><span class="mord textbf">v</span></span></span></span><span style="top:-2.2509em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">subject to:</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9091em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>To solved these constrained optimization problems we use the Lagrangian
multiplier to move the constraint into the optimization problem. This gives:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mtext mathvariant="bold">v</mtext><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mi mathvariant="normal">Σ</mi><mtext mathvariant="bold">v</mtext><mo>−</mo><mi>λ</mi><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\mathcal{L}(\textbf{v}, \lambda) = \textbf{v}^\top \Sigma \textbf{v} - \lambda (\textbf{v}^\top \textbf{v} - 1) \\[7pt]
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2591em;vertical-align:-0.8796em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3796em"><span style="top:-3.4804em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord">Σ</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8796em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Now we need to solve for the stationary point (taking the gradient w.r.t. each
variable and setting to zero). First, for the trivial case of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">λ</span></span></span></span> we find:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="normal">∇</mi><mi>λ</mi></msub><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mtext mathvariant="bold">v</mtext><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo>−</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mtext mathvariant="bold">v</mtext><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">v</mtext><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\nabla_{\lambda} \mathcal{L}(\textbf{v}, \lambda) &amp;= \textbf{v}^\top \textbf{v} - 1 = 0 \\
&amp; \textbf{v}^\top \textbf{v} = 1 \\
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1182em;vertical-align:-1.3091em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8091em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span></span></span><span style="top:-2.3509em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3091em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8091em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">0</span></span></span><span style="top:-2.3509em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3091em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>And then for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">v</mtext></mrow><annotation encoding="application/x-tex">\textbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span>:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="normal">∇</mi><mtext mathvariant="bold">v</mtext></msub><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mtext mathvariant="bold">v</mtext><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="normal">Σ</mi><mtext mathvariant="bold">v</mtext><mo>−</mo><mi>λ</mi><mtext mathvariant="bold">v</mtext><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">Σ</mi><mtext mathvariant="bold">v</mtext><mo>=</mo><mi>λ</mi><mtext mathvariant="bold">v</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\nabla_{\textbf{v}} \mathcal{L}(\textbf{v}, \lambda) &amp;= \Sigma \textbf{v} - \lambda \textbf{v} = 0 \\
&amp; \Sigma \textbf{v} = \lambda \textbf{v} \\
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">v</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">Σ</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">λ</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">0</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mord">Σ</span><span class="mord text"><span class="mord textbf">v</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal">λ</span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Now, because <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">Σ</span></span></span></span> is the covariance matrix, and is symmetric,
this is just the famous eigenvector problem. That is, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">v</mtext></mrow><annotation encoding="application/x-tex">\textbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">v</span></span></span></span></span> are the
eigenvectors of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">Σ</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">λ</span></span></span></span>
are the eigenvalues. But what does this mean? This means that the vectors we
want to project our data onto are the eigenvectors, with the largest eigenvalues,
of the covariance matrix (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">Σ</span></span></span></span>) of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span>. This is because it turns out that
the variance of our data onto some arbitrary eigenvector <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="bold">v</mtext><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\textbf{v}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> is just
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>. Here is the proof if your interested:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>Var</mtext><mtext> </mtext><mo stretchy="false">(</mo><msup><mi>X</mi><mi mathvariant="normal">⊤</mi></msup><msub><mtext mathvariant="bold">v</mtext><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mtext mathvariant="bold">v</mtext><mi>i</mi><mi mathvariant="normal">⊤</mi></msubsup><mi>X</mi><msup><mi>X</mi><mi mathvariant="normal">⊤</mi></msup><msub><mtext mathvariant="bold">v</mtext><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mtext mathvariant="bold">v</mtext><mi>i</mi><mi mathvariant="normal">⊤</mi></msubsup><mi mathvariant="normal">Σ</mi><msub><mtext mathvariant="bold">v</mtext><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mtext mathvariant="bold">v</mtext><mi>i</mi><mi mathvariant="normal">⊤</mi></msubsup><msub><mi>λ</mi><mi>i</mi></msub><msub><mtext mathvariant="bold">v</mtext><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>λ</mi><mi>i</mi></msub><msubsup><mtext mathvariant="bold">v</mtext><mi>i</mi><mi mathvariant="normal">⊤</mi></msubsup><msub><mtext mathvariant="bold">v</mtext><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>λ</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{Var} \: (X^\top \textbf{v}_i) &amp;= \frac{1}{n} \textbf{v}_i^\top X X^\top \textbf{v}_i \\
                               &amp;= \textbf{v}_i^\top \Sigma \textbf{v}_i \\
                               &amp;= \textbf{v}_i^\top \lambda_i \textbf{v}_i \\
                               &amp;= \lambda_i \textbf{v}_i^\top \textbf{v}_i \\
                               &amp;= \lambda_i 
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:8.4848em;vertical-align:-3.9924em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.4924em"><span style="top:-6.4924em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord text"><span class="mord">Var</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.6073em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"></span></span><span style="top:-3.0482em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"></span></span><span style="top:-1.4891em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"></span></span><span style="top:0.0109em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.9924em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.4924em"><span style="top:-6.4924em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-4.6073em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mord">Σ</span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.0482em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.4891em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:0.0109em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.9924em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Therefore as mentioned before, the eigenvectors with largest eigenvalues will be
the vectors we will want to project our space onto because they will maximize
the variance of our projected data. Furthermore, this is cool because it gives
us a way to measure how much variance we have captured. If using all of the
eigenvalues allows us to capture 100% of the variance, then the ratio of the sum
of eigenvalues used to the total eigenvalues allows us to find out how much
variance of the original dataset we have captured. This is an important
quantification that will allow us to systematically capture 90% of the variance
of our data (for example).</p>
<p>This gives us an algorithm for performing PCA on some dataset <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span>, and wraps up
our derivation. To perform PCA and project your dataset onto <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span> dimensions,
where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&lt;</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">n &lt; d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span>, you do the following:</p>
<ol>
<li>Mean center the dataset.</li>
<li>Compute the covariance matrix of the mean-centered dataset.</li>
<li>Compute the eigenvalues and eigenvector of the covariance matrix.</li>
<li>Project your dataset (via a dot product) onto the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span> eigenvectors with the
largest corresponding eigenvalues.</li>
</ol>
<h2 id="application-pca-on-genotypes">Application: PCA on Genotypes</h2>
<p>To bring this post full circle, let’s code a from scratch implementation of PCA
(in Python) and use it to reduce the dimensionality of genotype data, to see if
it’s possible to infer some underlying latent structure of the data.</p>
<p>Given that the genotype of any two individuals is roughly 99.6% alike [<span class="citation-ref" data-citation-id="1" data-astro-cid-tbsazfha>1</span>],
we would like to pick out what is different (the variants) and do dimensionality
reduction on those parts of the genome. Today, we identify these genetic variants
through a process called variant calling. In this post, the dataset we will be
using is from the 1000 Genomes Project [<span class="citation-ref" data-citation-id="1" data-astro-cid-tbsazfha>1</span>] and is given in the form of a
VCF (Variant Call Format) file, containing variants at various loci on an
individual’s chromosome.  Such variants include single nucleotide polymorphisms
(SNPs) or structural variants (SVs) such as insertion/deletions (INDELs) and
more.</p>
<p>This application was inspired by Maria Nattestad’s YouTube video [<span class="citation-ref" data-citation-id="3" data-astro-cid-tbsazfha>3</span>] and
implementation of this same project. Although, we believe this idea was
originally based off of this paper [<span class="citation-ref" data-citation-id="2" data-astro-cid-tbsazfha>2</span>], all of which can be found
in the references links.</p>
<p>For the dataset used in this post, we will be using a different dataset than the
original paper and a different chromosome of the same dataset that Maria
Nattestad used in her implementation. If you are following along, we also
recommend you use a different dataset, or the same dataset and a different
chromosome, than either Maria Nattestad (Chr 22) or this post (Chr 21) uses.</p>
<p>Also, this post does not include any of the functions to load/process the
dataset. If your following along, make sure to follow along from the notebook
on my
<a href="https://github.com/ryanirl/blog-supplementary/blob/3e6ec63bee460b345b3499ffa1fdc71c2d94039e/pca/pca.ipynb" target="_blank">GitHub</a>.</p>
<p>Now, let’s extract the important information from the VCF files, including the
allele’s and information about the population we sampled from.</p>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.0mma8.css"/><script type="module" src="/_astro/ec.dy9ns.js"></script><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">vcf_dir </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> </span><span style="--0:#9ECBFF;--1:#111111">&quot;</span><span style="--0:#9ECBFF;--1:#9B504E">path to VCF dir</span><span style="--0:#9ECBFF;--1:#111111">&quot;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">panel_dir </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> </span><span style="--0:#9ECBFF;--1:#111111">&quot;</span><span style="--0:#9ECBFF;--1:#9B504E">path to PANEL dir</span><span style="--0:#9ECBFF;--1:#111111">&quot;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">samples, genotypes, variant_ids </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> </span><span style="--0:#E1E4E8;--1:#097174">allele_indices</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">vcf_dir</span><span style="--0:#E1E4E8;--1:#111111">,</span><span style="--0:#E1E4E8;--1:#3C63B3"> skip_every</span><span style="--0:#E1E4E8;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">population_map, superpopulation_map </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> </span><span style="--0:#E1E4E8;--1:#097174">parse_panel</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">panel_dir</span><span style="--0:#E1E4E8;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616671"># Find the superpopulation of each sample.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">superpopulation </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> pd.</span><span style="--0:#E1E4E8;--1:#097174">Series</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">samples</span><span style="--0:#E1E4E8;--1:#403F53">).</span><span style="--0:#E1E4E8;--1:#097174">map</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">superpopulation_map</span><span style="--0:#E1E4E8;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">genotypes </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> np.</span><span style="--0:#E1E4E8;--1:#097174">array</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">genotypes</span><span style="--0:#E1E4E8;--1:#403F53">) </span><span style="--0:#99A0A6;--1:#616671"># shape: (samples, variant_count // skip_every, 2)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">genotypes </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> np.</span><span style="--0:#E1E4E8;--1:#097174">sum</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">genotypes</span><span style="--0:#E1E4E8;--1:#111111">,</span><span style="--0:#E1E4E8;--1:#3C63B3"> </span><span style="--0:#FFAB70;--1:#403F53">axis</span><span style="--0:#E1E4E8;--1:#3C63B3"> </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#3C63B3"> </span><span style="--0:#79B8FF;--1:#AA0982">2</span><span style="--0:#E1E4E8;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616671"># Reduce size due to compute constraints.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">genotypes_small </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> genotypes[::</span><span style="--0:#79B8FF;--1:#AA0982">10</span><span style="--0:#E1E4E8;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616671"># Number of alleles (m): 2076</span></div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616671"># Number of samples (n): 1092</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">m, n </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> genotypes_small.shape</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="vcf_dir = &#34;path to VCF dir&#34;panel_dir = &#34;path to PANEL dir&#34;samples, genotypes, variant_ids = allele_indices(vcf_dir, skip_every)population_map, superpopulation_map = parse_panel(panel_dir)# Find the superpopulation of each sample.superpopulation = pd.Series(samples).map(superpopulation_map)genotypes = np.array(genotypes) # shape: (samples, variant_count // skip_every, 2)genotypes = np.sum(genotypes, axis = 2)# Reduce size due to compute constraints.genotypes_small = genotypes[::10]# Number of alleles (m): 2076# Number of samples (n): 1092m, n = genotypes_small.shape"><div></div></button></div></figure></div>
<p>We will follow strictly the above mentioned procedure to perform PCA. First,
we must mean center the dataset.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616671"># Calculate and substract the mean.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">mean </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> np.</span><span style="--0:#E1E4E8;--1:#097174">mean</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">genotypes_small</span><span style="--0:#E1E4E8;--1:#111111">,</span><span style="--0:#E1E4E8;--1:#3C63B3"> </span><span style="--0:#FFAB70;--1:#403F53">axis</span><span style="--0:#E1E4E8;--1:#3C63B3"> </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#3C63B3"> </span><span style="--0:#79B8FF;--1:#AA0982">1</span><span style="--0:#E1E4E8;--1:#111111">,</span><span style="--0:#E1E4E8;--1:#3C63B3"> </span><span style="--0:#FFAB70;--1:#403F53">keepdims</span><span style="--0:#E1E4E8;--1:#3C63B3"> </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#3C63B3"> </span><span style="--0:#79B8FF;--1:#A54A4A">True</span><span style="--0:#E1E4E8;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">genotypes_normalized </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> genotypes_small </span><span style="--0:#F97583;--1:#8D46B4">-</span><span style="--0:#E1E4E8;--1:#403F53"> mean</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# Calculate and substract the mean.mean = np.mean(genotypes_small, axis = 1, keepdims = True)genotypes_normalized = genotypes_small - mean"><div></div></button></div></figure></div>
<p>Next, we compute the covariance matrix of the dataset (ether dividing by
n-1 or n, we will use n-1).</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">covariance </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> genotypes_normalized.</span><span style="--0:#E1E4E8;--1:#097174">dot</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">genotypes_normalized.T</span><span style="--0:#E1E4E8;--1:#403F53">) </span><span style="--0:#F97583;--1:#8D46B4">/</span><span style="--0:#E1E4E8;--1:#403F53"> (n </span><span style="--0:#F97583;--1:#8D46B4">-</span><span style="--0:#E1E4E8;--1:#403F53"> </span><span style="--0:#79B8FF;--1:#AA0982">1</span><span style="--0:#E1E4E8;--1:#403F53">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="covariance = genotypes_normalized.dot(genotypes_normalized.T) / (n - 1)"><div></div></button></div></figure></div>
<p>Next, compute the eigenvectors and eigenvalues of the covariance matrix.
Luckily for us, NumPy sort them automatically. This will make the selection step
easier.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">eig_values, eig_vectors </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> np.linalg.</span><span style="--0:#E1E4E8;--1:#097174">eigh</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">covariance</span><span style="--0:#E1E4E8;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616671"># They are in ascending order, we want the opposite.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">eig_values </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> eig_values[::</span><span style="--0:#F97583;--1:#8D46B4">-</span><span style="--0:#79B8FF;--1:#AA0982">1</span><span style="--0:#E1E4E8;--1:#403F53">]      </span><span style="--0:#99A0A6;--1:#616671"># shape (2076,)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">eig_vectors </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> eig_vectors[:, ::</span><span style="--0:#F97583;--1:#8D46B4">-</span><span style="--0:#79B8FF;--1:#AA0982">1</span><span style="--0:#E1E4E8;--1:#403F53">] </span><span style="--0:#99A0A6;--1:#616671"># shape (2076, 2076)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="eig_values, eig_vectors = np.linalg.eigh(covariance)# They are in ascending order, we want the opposite.eig_values = eig_values[::-1]      # shape (2076,)eig_vectors = eig_vectors[:, ::-1] # shape (2076, 2076)"><div></div></button></div></figure></div>
<p>As a side note, let’s test how much variance is captured by selecting more and
more components.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">np.</span><span style="--0:#E1E4E8;--1:#097174">cumsum</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">eig_values </span><span style="--0:#F97583;--1:#8D46B4">/</span><span style="--0:#E1E4E8;--1:#3C63B3"> np.</span><span style="--0:#E1E4E8;--1:#097174">sum</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">eig_values</span><span style="--0:#E1E4E8;--1:#403F53">))</span><span style="--0:#E1E4E8;--1:#111111">[</span><span style="--0:#79B8FF;--1:#AA0982">0</span><span style="--0:#E1E4E8;--1:#403F53">:</span><span style="--0:#79B8FF;--1:#AA0982">10</span><span style="--0:#E1E4E8;--1:#111111">]</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="np.cumsum(eig_values / np.sum(eig_values))[0:10]"><div></div></button></div></figure></div>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#403f53">array([0.0831045 , 0.13070515, 0.14289654, 0.15236331, 0.16062823,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#403f53">        </span></span><span style="--0:#e1e4e8;--1:#403f53">0.16877235, 0.17622259, 0.18349874, 0.19060836, 0.19756033])</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="array([0.0831045 , 0.13070515, 0.14289654, 0.15236331, 0.16062823,        0.16877235, 0.17622259, 0.18349874, 0.19060836, 0.19756033])"><div></div></button></div></figure></div>
<p>We can see that by taking <code>n_components=1</code> then we will capture 8.3% of the
variance of the original dataset, by taking <code>n_components=2</code> then we will
capture 13.1% of the variance, and so on.</p>
<p>For visualization purposes, let’s take <code>n_components=2</code>. The eigenvalues are
already sorted in descending order. Because the covariance matrix is positive
semi-definite, <code>s = d.T</code>, and we can just take the leading two principle
components straight from <code>s</code>.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">pc1 </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> eig_vectors[:, </span><span style="--0:#79B8FF;--1:#AA0982">0</span><span style="--0:#E1E4E8;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">pc2 </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> eig_vectors[:, </span><span style="--0:#79B8FF;--1:#AA0982">1</span><span style="--0:#E1E4E8;--1:#403F53">]</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="pc1 = eig_vectors[:, 0]pc2 = eig_vectors[:, 1]"><div></div></button></div></figure></div>
<p>Now we do a change of basis of our original dataset with our PC1 and PC2 forming
the new subspace. This is the final “dimensionality reduction” step. Because the
eigenvectors are of normal length, projecting out data onto this space is just a
simple dot product.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">pc1_plot </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> genotypes_normalized.T.</span><span style="--0:#E1E4E8;--1:#097174">dot</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">pc1</span><span style="--0:#E1E4E8;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#403F53">pc2_plot </span><span style="--0:#F97583;--1:#8D46B4">=</span><span style="--0:#E1E4E8;--1:#403F53"> genotypes_normalized.T.</span><span style="--0:#E1E4E8;--1:#097174">dot</span><span style="--0:#E1E4E8;--1:#403F53">(</span><span style="--0:#E1E4E8;--1:#3C63B3">pc2</span><span style="--0:#E1E4E8;--1:#403F53">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="pc1_plot = genotypes_normalized.T.dot(pc1)pc2_plot = genotypes_normalized.T.dot(pc2)"><div></div></button></div></figure></div>
<p>Now lets visualize the reduced dataset.</p>
<center><figure><img src="/img/pca/reduced_custom.png" style="width: 50%;"/><figcaption><p><b>Figure 3:</b> Genotype data projected onto PC1 and PC2, colored by the superpopulation code.</p></figcaption></figure></center>
<p>In <strong>Figure 3</strong>, each point represents an individual (sample), colored by their
superpopulation. From this, we can see a clear clustering of individuals based
on their genetic ancestry, with distinct groupings corresponding to different
superpopulations (Europe, Asia, America, and Africa). This demonstrates how
PCA can be used to visualize underlying high-dimensional latent structure in
2 dimensions, which only captures about 13% of the total variance.</p>
<p>We can also compare this with the scikit-learn PCA implementation to verify to
ourselves that what we have done is correct. Additionally, in the notebook we
performed an unsupervised clustering step. If your interested in checking these
out, check out my
<a href="https://github.com/ryanirl/blog-supplementary/blob/3e6ec63bee460b345b3499ffa1fdc71c2d94039e/pca/pca.ipynb" target="_blank">GitHub</a>.</p>
<p>In this post, we introduced principal components analysis (PCA) as a method
for unsupervised dimensionality reduction, formally derived PCA from first
principles, and applied it to a real-world genomic dataset to infer underlying
high-dimensional latent structure.</p>
<p>Full examples can be found on my
<a href="https://github.com/ryanirl/blog-supplementary/blob/3e6ec63bee460b345b3499ffa1fdc71c2d94039e/pca/pca.ipynb" target="_blank">GitHub</a>.</p>
<div id="citations-data" style="display: none;" data-astro-cid-eqo3tkq5> [{&quot;id&quot;:1,&quot;title&quot;:&quot;A global reference for human genetic variation.&quot;,&quot;authors&quot;:[&quot;The 1000 Genomes Project Consortium&quot;],&quot;year&quot;:2015,&quot;url&quot;:&quot;https://doi.org/10.1038/nature15393&quot;},{&quot;id&quot;:2,&quot;title&quot;:&quot;Genes mirror geography within Europe&quot;,&quot;authors&quot;:[&quot;Novembre, J., Johnson, T., Bryc, K., Kutalik, Z., Boyko, A. R., Auton, A., Indap, A., King, K. S., Bergmann, S., Nelson, M. R., Stephens, M., &amp; Bustamante, C. D.&quot;],&quot;year&quot;:2008,&quot;url&quot;:&quot;https://doi.org/10.1038/nature07331&quot;},{&quot;id&quot;:3,&quot;title&quot;:&quot;Genes and geography -- a bioinformatics project&quot;,&quot;authors&quot;:[&quot;Nattestad, M.&quot;],&quot;year&quot;:2021,&quot;url&quot;:&quot;https://www.youtube.com/watch?v=-PCKK_nwFdA&quot;}] </div> <div class="citation-tooltip" id="citationTooltip" data-astro-cid-eqo3tkq5></div> <h2 data-astro-cid-eqo3tkq5>References</h2> <ol class="references-list" data-astro-cid-eqo3tkq5> <li id="citation-1" data-astro-cid-eqo3tkq5> The 1000 Genomes Project Consortium (2015). A global reference for human genetic variation..
<a href="https://doi.org/10.1038/nature15393" target="_blank" rel="noopener noreferrer" data-astro-cid-eqo3tkq5> Link</a> </li><li id="citation-2" data-astro-cid-eqo3tkq5> Novembre, J., Johnson, T., Bryc, K., Kutalik, Z., Boyko, A. R., Auton, A., Indap, A., King, K. S., Bergmann, S., Nelson, M. R., Stephens, M., &amp; Bustamante, C. D. (2008). Genes mirror geography within Europe.
<a href="https://doi.org/10.1038/nature07331" target="_blank" rel="noopener noreferrer" data-astro-cid-eqo3tkq5> Link</a> </li><li id="citation-3" data-astro-cid-eqo3tkq5> Nattestad, M. (2021). Genes and geography -- a bioinformatics project.
<a href="https://www.youtube.com/watch?v=-PCKK_nwFdA" target="_blank" rel="noopener noreferrer" data-astro-cid-eqo3tkq5> Link</a> </li> </ol>  
<h2 id="figures">Figures</h2>
<ol>
<li>Custom. Vector and scalar projections.</li>
<li>Maximizing the variance versus minimizing the residuals.
<a href="https://towardsdatascience.com/principal-component-analysis-the-machine-learning-perspective-part-2-a2630fa3b89e" target="_blank">Link</a>.</li>
<li>Custom. Projection of genotype data into 2 dimensions.
<a href="https://github.com/ryanirl/blog-supplementary/blob/3e6ec63bee460b345b3499ffa1fdc71c2d94039e/pca/pca.ipynb" target="_blank">Link</a>.</li>
</ol>  </div> </div>  </div> </body></html>